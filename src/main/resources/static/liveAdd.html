<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>听会儿中医APP 后台管理系统</title>
	<!-- Tell the browser to be responsive to screen width -->
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	<!-- Bootstrap 3.3.7 -->
	<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="bower_components/font/ico.css">
	<link rel="Shortcut Icon" href="dist/img/favicon.ico">
	<!-- Ionicons -->
	<link rel="stylesheet" href="bower_components/Ionicons/css/ionicons.min.css">
	<!-- Theme style -->
	<link rel="stylesheet" href="dist/css/AdminLTE.min.css">
	<!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
	<link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">
	<link rel="stylesheet" href="dist/css/style.css">
	<!-- jQuery 3 -->
	<script type="text/javascript" src="bower_components/jquery/dist/jquery.min.js"></script>
	<script type="text/javascript" src="dist/js/sessionStorage.js"></script>
	<script type="text/javascript" src="dist/js/confirm.js"></script>
	<script type="text/javascript" src="dist/js/xlsx.core.min.js"></script>
	<script type="text/javascript" src="dist/js/jquery-sortable.js"></script>
	<script type="text/javascript" src="dist/js/pages/liveAdd.js"></script>


</head>

<body class="hold-transition skin-blue sidebar-mini">
	<!-- Site wrapper -->
	<div class="wrapper">

		<header class="main-header">
			<!-- Logo -->
			<a href="./index.html" class="logo">
				<!-- mini logo for sidebar mini 50x50 pixels -->
				<span class="logo-mini"><i class="icon-ha2"></i></span>
				<!-- logo for regular state and mobile devices -->
				<span class="logo-lg"><b><i class="icon-hou"></i>&nbsp;<i class="icon-ai"></i></b>&nbsp;听会儿中医</span>
			</a>
			<!-- Header Navbar: style can be found in header.less -->
			<nav class="navbar navbar-static-top">
				<!-- Sidebar toggle button-->
				<a href="javascript:void(0);" class="sidebar-toggle" data-toggle="push-menu" role="button">
					<span class="sr-only">导航栏</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</a>

				<div class="navbar-custom-menu">
					<ul class="nav navbar-nav">
						<!-- Messages: style can be found in dropdown.less-->
						<li class="messages-menu">
							<a href="javascript:void(0);" class="dropdown-toggle" id="logout" data-toggle="dropdown">
								<i class="icon-power-off"></i>
							</a>
						</li>
						<!-- Control Sidebar Toggle Button -->
						<li>
							<a href="javascript:void(0);" data-toggle="control-sidebar"><i class="fa fa-gears"></i></a>
						</li>
					</ul>
				</div>
			</nav>
		</header>

		<!-- =============================================== -->

		<!-- Left side column. contains the sidebar -->
		<aside class="main-sidebar">
			<!-- sidebar: style can be found in sidebar.less -->
			<section class="sidebar">
				<!-- Sidebar user panel -->
				<div class="user-panel">
					<div class="pull-left image">
						<img src="dist/img/avatar.jpg" class="img-circle" alt="User Image">
					</div>
					<div class="pull-left info">
						<p>管理员</p>
						<a href="javascript:void(0);"><i class="fa fa-circle text-success"></i> 写点啥</a>
					</div>
				</div>
				<!-- sidebar menu: : style can be found in sidebar.less -->
				<ul class="sidebar-menu" data-widget="tree">
					<li class="header"><a href="javascript:void(0);" class="null">&nbsp;</a></li>
					<li><a href="index.html"><i class="fa fa-book"></i> <span>首页</span></a></li>
					<li>
						<a href="album.html">
							<i class="fa fa-folder-open"></i> <span>专辑管理</span>
						</a>
					</li>
					<li class="treeview">
						<a href="javascript:void(0);">
							<i class="fa fa-file"></i>
							<span>课程管理</span>
							<span class="pull-right-container">
								<i class="fa fa-angle-left pull-right"></i>
							</span>
						</a>
						<ul class="treeview-menu">
							<li><a href="course.html"><i class="fa fa-circle-o"></i> 课程列表</a></li>
							<li><a href="commentCourse.html"><i class="fa fa-circle-o"></i> 课程评论</a></li>
						</ul>
					</li>
					<li class="treeview active">
						<a href="javascript:void(0);">
							<i class="fa fa-play-circle-o"></i>
							<span>直播管理</span>
							<span class="pull-right-container">
								<i class="fa fa-angle-left pull-right"></i>
							</span>
						</a>
						<ul class="treeview-menu">
							<li><a href="liveList.html"><i class="fa fa-circle-o"></i> 直播列表</a></li>
							<li class="active"><a href="liveAdd.html"><i class="fa fa-circle-o"></i> 添加直播</a></li>
							<li><a href="memory.html"><i class="fa fa-circle-o"></i> 并发管理</a></li>
						</ul>
					</li>
					<li class="treeview">
						<a href="javascript:void(0);">
							<i class="fa fa-files-o"></i>
							<span>文章管理</span>
							<span class="pull-right-container">
								<i class="fa fa-angle-left pull-right"></i>
							</span>
						</a>
						<ul class="treeview-menu">
							<li><a href="article.html"><i class="fa fa-circle-o"></i> 文章列表</a></li>
							<li><a href="articleAdd.html"><i class="fa fa-circle-o"></i> 发布文章</a></li>
							<!-- <li><a href="type.html?action=article"><i class="fa fa-circle-o"></i> 文章分类</a></li> -->
							<li><a href="commentArticle.html"><i class="fa fa-circle-o"></i> 文章评论</a></li>
						</ul>
					</li>
					<li class="treeview">
						<a href="javascript:void(0);">
							<i class="fa fa-flag"></i>
							<span>活动管理</span>
							<span class="pull-right-container">
								<i class="fa fa-angle-left pull-right"></i>
							</span>
						</a>
						<ul class="treeview-menu">
							<li><a href="slider.html"><i class="fa fa-circle-o"></i> 轮播管理</a></li>
							<li><a href="ad.html"><i class="fa fa-circle-o"></i> 广告管理</a></li>

						</ul>
					</li>
					<li class="treeview">
						<a href="javascript:void(0);">
							<i class="fa fa-tag"></i>
							<span>帮助&反馈</span>
							<span class="pull-right-container">
								<i class="fa fa-angle-left pull-right"></i>
							</span>
						</a>
						<ul class="treeview-menu">
							<li><a href="help.html"><i class="fa fa-circle-o"></i> 帮助中心</a></li>
							<li><a href="opinion.html"><i class="fa fa-circle-o"></i> 意见反馈</a></li>

						</ul>
					</li>
					<li class="treeview">
						<a href="javascript:void(0);">
							<i class="fa fa-shopping-cart"></i>
							<span>商城管理</span>
							<span class="pull-right-container">
								<i class="fa fa-angle-left pull-right"></i>
							</span>
						</a>
						<ul class="treeview-menu">
							<li><a href="mall.html"><i class="fa fa-circle-o"></i> 商城管理</a></li>
						</ul>
					</li>
				</ul>
			</section>
			<!-- /.sidebar -->
		</aside>

		<!-- =============================================== -->

		<!-- Content Wrapper. Contains page content -->
		<div class="content-wrapper">
			<!-- Content Header (Page header) -->
			<section class="content-header">
				<h1>
					直播管理
					<small>添加直播</small>
				</h1>
				<ol class="breadcrumb">
					<li><a href="javascript:void(0);"><i class="fa fa-book"></i> 首页</a></li>
					<li class="active">直播管理</li>
					<li class="active">添加直播</li>
				</ol>
			</section>

			<!-- Main content -->
			<section class="content">
				<div class="row">
					<div class="col-xs-12">
						<div class="box box-primary">
							<div class="box-header">
								<h3 class="box-title"></h3>
							</div>
							<!-- /.box-header -->
							<div class="box-body">
								<form id="zhibo_msg_list" enctype="multipart/form-data" data-id=""
									class="form-horizontal style-form">
									<input type="hidden" name="liveMaster.id" class="live_id" value="">
									<input type="hidden" name="liveMaster.operatorId" class="live_updater" value="">
									<div class="col-md-12 col-lg-12">
										<div class="form-group">
											<label class="col-sm-2 col-md-2 control-label"><span class="text-danger">*
												</span>标题：</label>
											<div class="col-sm-6 col-md-6">
												<input type="text" class="form-control live_title"
													name="liveMaster.liveMasterName">
											</div>
											<div class="col-sm-4 col-md-4"></div>
										</div>
										<div class="form-group">
											<label class="col-sm-2 col-md-2 control-label"><span class="text-danger">*
												</span>副标题：</label>
											<div class="col-sm-6 col-md-6">
												<input type="text" class="form-control live_describe"
													name="liveMaster.liveMasterDescribe">
											</div>
											<div class="col-sm-4 col-md-4"></div>
										</div>
										<div class="form-group hide">
											<label class="col-sm-2 col-md-2 control-label"><span class="text-danger">*
												</span>直播时间：</label>
											<div class="col-sm-6 col-md-6">
												<input type="text" id="live_time" class="form-control live_time_start"
													name="liveMaster.startTime" value="">
											</div>
											<input type="hidden" class="form-control live_time_end"
												name="liveMaster.endTime" value="">
											<div class="col-sm-4 col-md-4"></div>
										</div>
									</div>
									<div class="col-md-12 col-lg-12">
										<input type="hidden" name="courseId" id="courseId" value="" />
										<div class="form-group clear">
											<div class="col-md-12 col-lg-12">
												<div class="col-md-9 col-lg-9">
												</div>
												<div class="col-md-1 col-lg-1 text-right">
													<button type="button" id="excel_file"
														class="btn btn-primary">EXCEL导入</button>
													<div class="hide">
														<input type="file" id="excel-file">
													</div>
												</div>
												<div class="col-md-1 col-lg-1 text-right">
													<a class="btn btn-primary template_download"
														href="files/template.xls" target="_blank">模版下载</a>
												</div>
												<div class="col-md-1 col-lg-1 text-right">
													<button type="button" data-value="0"
														class="btn btn-primary list_clear">清空</button>
												</div>
											</div>
											<div class="col-md-12 col-lg-12 zhibo_msg">
												<ul class="exceltitle">
													<li>
														<div>发言人</div>
														<div>类型</div>
														<div>内容</div>
														<div>操作</div>
													</li>
												</ul>
												<ol class="load_table">
												</ol>
											</div>
										</div>
										<div class="form-group text-left clear">
											<div class="col-md-2 col-lg-2">
												<button type="button"
													class="btn btn-primary zhibo_msg_add">增加内容</button>
											</div>
											<div class="col-md-10 col-lg-10"></div>
										</div>
										<div class="form-group text-right clear">
											<div class="col-md-12 col-lg-12">
												<button type="button" id="zhibo_submit"
													class="btn btn-primary zhibo_submit">提交</button>
											</div>
										</div>
									</div>
								</form>
							</div>
							<!-- /.box-body -->
						</div>
						<!-- /.box -->
					</div>
					<!-- /.col -->
				</div>
				<!-- /.row -->
			</section>
			<!-- /.content -->
		</div>
		<!-- /.content-wrapper -->



		<div class="single_msg">
			<div class="mask"></div>
			<div class="single_msg_content box box-primary">
				<div class="box-header with-border">
					<h3 class="box-title slide_add_box_title">添加</h3>
				</div>
				<form id="zhibo_msg_list" enctype="multipart/form-data" class="form-horizontal style-form">
					<div class="box-body">
						<div class="form-group">
							<label class="col-sm-3 col-md-3 control-label">发言人：</label>
							<div class="col-md-9 col-lg-9">
								<input type="text" name="new_msg_speaker" class="new_msg_speaker form-control">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 col-md-3 control-label">类型：</label>
							<div class="col-md-9 col-lg-9">
								<input type="radio" name="new_msg_type" class="new_msg_type" value="1"
									checked />文字&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
								<input type="radio" name="new_msg_type" class="new_msg_type"
									value="2" />音频&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
								<input type="radio" name="new_msg_type" class="new_msg_type" value="3" />图片
							</div>
						</div>
						<div class="form-group new_msg_file_box">
							<label class="col-sm-3 col-md-3 control-label">文件：</label>
							<div class="col-md-9 col-lg-9">
								<button type="button" class="btn btn-primary new_msg_file"><i
										class="icon-cloud-upload"></i>
									上传文件</button>
							</div>
							<div class="hide">

							</div>
						</div>
						<div class="form-group new_msg_file_box">
							<label class="col-sm-3 col-md-3 control-label">链接：</label>
							<div class="col-md-9 col-lg-9">
								<input type="text" class="new_msg_file_url form-control" name="new_msg_file_url">
							</div>
						</div>
						<div class="form-group new_msg_word_box">
							<label class="col-sm-3 col-md-3 control-label">内容：</label>
							<div class="col-md-9 col-lg-9">
								<textarea class="new_msg_word form-control" wrap="hard" name="new_msg_word"></textarea>
							</div>
						</div>
					</div>
					<div class="box-footer">
						<div class="form-group">
							<div class="col-md-12 col-lg-12 text-right">
								<button type="button"
									class="btn btn-primary new_msg_add">添加</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
								<button type="button" class="btn btn-default new_msg_cancel">取消</button>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
		<div class="single_edit">
			<div class="mask"></div>
			<div class="single_edit_content box box-primary">
				<div class="box-header with-border">
					<h3 class="box-title slide_add_box_title">编辑</h3>
				</div>
				<form id="single_edit_form" enctype="multipart/form-data" class="form-horizontal style-form">
					<div class="box-body">
						<div class="form-group new_edit_file_box">
							<label class="col-sm-3 col-md-3 control-label">文件：</label>
							<div class="col-md-9 col-lg-9">
								<button type="button" class="btn btn-primary edit_msg_file"><i
										class="icon-cloud-upload"></i>
									上传文件</button>
							</div>
						</div>
						<div class="form-group new_edit_file_box">
							<label class="col-sm-3 col-md-3 control-label">链接：</label>
							<div class="col-md-9 col-lg-9">
								<input type="text" class="edit_msg_file_url form-control" name="new_msg_file_url">
							</div>
						</div>
					</div>
					<div class="box-footer">
						<div class="form-group">
							<div class="col-md-12 col-lg-12 text-right">
								<button type="button"
									class="btn btn-primary edit_msg_submit">修改</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
								<button type="button" class="btn btn-default edit_msg_cancel">取消</button>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>



		<footer class="main-footer">
			<div class="pull-right hidden-xs">
				<b>Version</b> 0.0.1
			</div>
			<strong>Copyright &copy; 吉林省后爱电子商务有限公司
		</footer>

		<!-- Control Sidebar -->
		<aside class="control-sidebar control-sidebar-dark">
			<!-- Create the tabs -->
			<ul class="nav nav-tabs nav-justified control-sidebar-tabs">
			</ul>
			<!-- Tab panes -->
			<div class="tab-content">
				<!-- Home tab content -->
				<div class="tab-pane" id="control-sidebar-home-tab">
				</div>
			</div>
		</aside>
		<!-- /.control-sidebar -->
		<!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
		<div class="control-sidebar-bg"></div>
	</div>
	<!-- ./wrapper -->

	<!-- Bootstrap 3.3.7 -->
	<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<!-- SlimScroll -->
	<script src="bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
	<!-- FastClick -->
	<script src="bower_components/fastclick/lib/fastclick.js"></script>
	<!-- AdminLTE App -->
	<script src="dist/js/adminlte.min.js"></script>
	<!-- AdminLTE for demo purposes -->
	<script src="dist/js/demo.js"></script>
	<script>
		$(document).ready(function () {
			$('.sidebar-menu').tree();
			$('#excel-file').change(function (e) {
				var files = e.target.files;
				var file_name = $(this).val();
				if (file_name != '') {
					var suffix_file = file_name.substr(file_name.lastIndexOf("."));
					//console.log(suffix_file);
					if (suffix_file !== '.xls' && suffix_file !== '.XLS' && suffix_file !== '.xlsx' &&
						suffix_file !==
						'.XLSX' && suffix_file !== '.et' && suffix_file !== '.ET') {
						alert('请上传正确的EXCEL文件(xls、xlsx、et)!');
						return false;
					}
				} else {
					return false;
				}
				var fileReader = new FileReader();
				fileReader.onload = function (ev) {
					try {
						var data = ev.target.result,
							workbook = XLSX.read(data, {
								type: 'binary'
							}), // 以二进制流方式读取得到整份excel表格对象
							persons = []; // 存储获取到的数据
					} catch (e) {
						//console.log('文件类型不正确');
						return;
					}
					var fromTo = '';
					for (var sheet in workbook.Sheets) {
						if (workbook.Sheets.hasOwnProperty(sheet)) {
							fromTo = workbook.Sheets[sheet]['!ref'];
							//console.log(fromTo);
							persons = persons.concat(XLSX.utils.sheet_to_json(workbook.Sheets[sheet]));
							break;
						}
					}
					//$(".load_table").html("");
					var li = "";
					for (var j = 0; j < persons.length; j++) {
						var arr = persons[j];

						var _tmp = '';
						var ii = 0;
						for (var i in arr) {
							ii++
							if (ii == 1) {
								_tmp +=
									'<div><input type="hidden" class="courseId" value="" name=""><input type="text" class="speaker form-control" value="' +
									arr[i] + '" name="name"></div>';
							}
							if (ii == 2) {
								_tmp += '<div>' + arr[i] + '</div>';
							}
							if (ii == 3) {
								var this_val = arr[i];
								var this_type = '1';
								var point = this_val.lastIndexOf(".");
								var type = this_val.substr(point);
								//console.log(type);
								if (type == ".jpg" || type == ".gif" || type == ".JPG" || type ==
									".GIF" ||
									type == ".PNG" || type == ".png") {
									this_val = '<img class="img_in_table" src="' + arr[i] +
										'" /><a href="javascript:void(0)" class="url_change"><i class="icon-folder-open"></i></a>';
									this_type = '3';
								} else if (type == ".mp3" || type == ".MP3" || type == ".wav" || type ==
									".WAV" ||
									type == ".WMA" || type == ".wma") {
									this_val = '<audio src="' + arr[i] +
										'" class="audio_36" controls="controls">浏览器不支持audio标签</audio><a href="javascript:void(0)" class="url_change"><i class="icon-folder-open"></i></a>';
									this_type = '2';
								} else {
									this_val = '<p>' + arr[i] + '</p>';
								}
								_tmp += "<div class='l_d' data-type='" + this_type + "'>" + this_val +
									"<div class='hide'><input class='this_value' type='hidden' value='" +
									arr[i] +
									"' name='' /><input class='this_type' type='hidden' value='' name='' /></div></div>";
							}
						}
						li +=
							"<li data-order='' class='excelcontent'>" + _tmp +
							"<div><button type='button' class='delete btn btn-primary' href='javascript:void(0);'>删除</button><input class='audio_times' type='hidden' value='0' name='times' /></div></li>";
					}
					$(".load_table").append(li);
				};
				fileReader.readAsBinaryString(files[0]);
			});
			$(function () {
				$("ol.load_table").sortable();
			});
		});
	</script>
</body>

</html>