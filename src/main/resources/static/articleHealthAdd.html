<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="sain">
    <meta name="keyword" content="">

    <title>直播管理</title>
    <script type="text/javascript" src="assets/js/jquery.js"></script>
    <script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <link href="assets/css/ico.css" rel="stylesheet" />
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="assets/css/style-responsive.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/jodit/build/jodit.min.css" />
    <!--[if lt IE 9]>
      <script src="assets/js/html5shiv.js"></script>
      <script src="assets/js/respond.min.js"></script>
    <![endif]-->
</head>

<body>

    <section id="container">
        <header class="header black-bg">
            <div class="sidebar-toggle-box">
                <div class="bars icon-align-justify tooltips" data-placement="right"
                    data-original-title="Toggle Navigation"></div>
            </div>
            <a href="index.html" class="logo"><i class="icon-hou"></i><i class="icon-ai"></i><span>直播管理</span></a>
            <div class="nav notify-row" id="top_menu">
                <ul class="nav top-menu">
                    <li class="dropdown">
                        <a class="logout" id="logout" href="javascript:void(0);">
                            <i class="icon-power-off"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </header>
        <aside>
            <div id="sidebar" class="nav-collapse ">
                <ul class="sidebar-menu" id="nav-accordion">
                    <p class="centered"><a href="javascript:;"><img src="assets/img/avatar.jpg" class="img-circle"
                                width="60"></a></p>
                    <h5 class="centered curr_admin_name">-</h5>
                    <li class="mt">
                        <a href="index.html">
                            <i class="icon-dashboard"></i>
                            <span>首页</span>
                        </a>
                    </li>
                    <li class="sub-menu">
                        <a class="active" href="javascript:;">
                            <i class="icon-hou"></i>
                            <span>专辑管理</span>
                        </a>
                        <ul class="sub">
                            <li><a href="articleHealth.html">课程管理</a></li>
                            <li class="active"><a href="articleHealthAdd.html">课程添加</a></li>
                            <li><a href="courseMemory.html">课程缓存</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </aside>
        <section id="main-content">
            <section class="wrapper site-min-height">
                <div class="row">
                    <div class="col-lg-12 col-md-12">
                        <div class="row mt">
                            <div class="col-md-12 col-lg-12">
                                <div class="content-panel">
                                    <h4><i class="fa fa-angle-right"></i> >课程添加</h4>
                                    <hr>
                                    <form id="articleHealthAdd" enctype="multipart/form-data"
                                        class="form-horizontal style-form">
                                        <input type="hidden" name="course_create_id" class="course_create_id"
                                            value="" />
                                        <input type="hidden" name="course_update_id" class="course_update_id"
                                            value="" />
                                        <input type="hidden" name="id" class="edit_id" value="" />
                                        <div class="col-md-8 col-lg-8">
                                            <div class="form-group">
                                                <label class="col-sm-2 col-md-2 control-label"><span
                                                        class="text-danger">* </span>课程标题：</label>
                                                <div class="col-sm-10">
                                                    <input type="text" class="form-control course_title"
                                                        name="course_title">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 col-md-2 control-label"><span
                                                        class="text-danger">* </span>课程描述：</label>
                                                <div class="col-sm-10">
                                                    <input type="text" class="form-control  course_describe"
                                                        name="course_describe">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 col-md-2 control-label">关键字：</label>
                                                <div class="col-sm-10">
                                                    <input type="text" class="form-control course_key_words"
                                                        name="course_key_words">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 col-md-2 control-label">标 签：</label>
                                                <div class="col-sm-10">
                                                    <input type="text" class="form-control course_label"
                                                        name="course_label">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 col-md-2 control-label">
                                                    <span class="text-danger">* </span>课程分类：
                                                </label>
                                                <div class="col-sm-3 col-md-3">
                                                    <select class="course_type_id form-control" name="course_type_id">
                                                    </select>
                                                </div>
                                                <div class="col-sm-2 col-md-2"></div>
                                            </div>
                                            <div class="form-group hide">
                                                <label class="col-sm-2 col-md-2 control-label">
                                                    <span class="text-danger">* </span>是否上线：
                                                </label>
                                                <div class="col-sm-4">
                                                    <div class="switch has-switch switch-online" data-value="0">
                                                        <div class="switch-off switch-animate">
                                                            <input type="hidden" value="0" name="course_online"
                                                                class="course_online">
                                                            <span class="switch-left">上线</span>
                                                            <label>&nbsp;</label>
                                                            <span class="switch-right">下线</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <label class="col-sm-2 col-md-2 control-label">是否推荐：</label>
                                                <div class="col-sm-4">
                                                    <div class="switch has-switch switch-recommend" data-value="0">
                                                        <div class="switch-off switch-animate">
                                                            <input type="hidden" value="0" name="course_recommend"
                                                                class="course_recommend">
                                                            <span class="switch-left">是</span>
                                                            <label>&nbsp;</label>
                                                            <span class="switch-right">否</span>;
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 col-sm-2 control-label"><span
                                                        class="text-danger">* </span>上传音频：</label>
                                                <div class="col-sm-8">
                                                    <audio src="" class="audio_36 radioFile_preview"
                                                        controls="controls">
                                                        浏览器不支持audio标签
                                                    </audio>
                                                    <div class="hide">
                                                        <input type="hidden" class="course_audio_times"
                                                            name="course_audio_times" value="0">
                                                        <input type="file" class="radioFile" name="radioFile" value="">
                                                        <input type="hidden" class="course_audio_url"
                                                            name="course_audio_url" value="" />
                                                    </div>
                                                </div>
                                                <div class="col-sm-2">
                                                    <button type="button"
                                                        class="btn btn-theme03 choose_radio">选择文件</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 col-lg-4">
                                            <div class="form-group article_logo">
                                                <div class="col-md-12 col-lg-12">
                                                    <span class="text-danger">* </span>封面图片：
                                                </div>
                                                <div class="col-md-12 col-lg-12">
                                                    <a href="javascript:void(0);" class="article_logo_img">
                                                        <img src="./assets/img/add.png" />
                                                    </a>
                                                    <div class="hide">
                                                        <input type="file" class="titleFile" name="titleFile">
                                                        <input type="hidden" class="course_logo" name="course_logo">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-md-12 col-lg-12">
                                                <textarea id="editor" class="course_content"
                                                    name="course_content"></textarea>
                                            </div>
                                        </div>
                                        <div class="form-group text-right clear">
                                            <div class="col-md-12 col-lg-12">
                                                <button type="button" class="btn btn-theme article_submit">发布课程</button>
                                            </div>
                                        </div>
                                    </form>
                                    <form id="zhibo_msg_list" enctype="multipart/form-data" data-type='url_Ext_add'
                                        data-article-id="" class="form-horizontal style-form">
                                        <input type="hidden" name="courseId" id="courseId" value="" />
                                        <div class="form-group clear">
                                            <div class="col-md-12 col-lg-12">
                                                <div class="col-md-2 col-lg-2">
                                                    <button type="button" id="excel_file"
                                                        class="btn btn-theme03">EXCEL导入</button>
                                                    <div class="hide">
                                                        <input type="file" id="excel-file">
                                                    </div>
                                                </div>
                                                <div class="col-md-2 col-lg-2">
                                                    <a class="btn btn-theme03 template_download"
                                                        href="./assets/file/template.xls" target="_blank">模版下载</a>
                                                </div>
                                                <div class="col-md-2 col-lg-2">
                                                    <button type="button"
                                                        class="btn btn-theme03 zhibo_msg_add">+</button>
                                                </div>
                                                <div class="col-md-2 col-lg-2">&nbsp;</div>
                                                <div class="col-md-2 col-lg-2">
                                                    <!-- <button type="button" data-value="0"
                                                        class="btn btn-theme03 course_status">点击发布直播</button> -->
                                                </div>
                                                <div class="col-md-2 col-lg-2 text-right">
                                                    <button type="button" data-value="0"
                                                        class="btn btn-theme03 list_clear">清空列表</button>
                                                </div>
                                            </div>
                                            <div class="col-md-12 col-lg-12 zhibo_msg">
                                                <ul class="exceltitle">
                                                    <li>
                                                        <div>发言人</div>
                                                        <div>类型</div>
                                                        <div>内容</div>
                                                        <div>操作</div>
                                                    </li>
                                                </ul>
                                                <ol class="load_table">
                                                </ol>
                                            </div>
                                        </div>
                                        <div class="form-group text-right clear">
                                            <div class="col-md-12 col-lg-12">
                                                <button type="button" class="btn btn-theme zhibo_submit">提交</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </section>
        
        <div class="single_msg">
            <div class="mask"></div>
            <div class="single_msg_content">
                <form id="zhibo_msg_list" enctype="multipart/form-data" data-article-id="1"
                    class="form-horizontal style-form">
                    <div class="form-group">
                        <label class="col-sm-3 col-md-3 control-label">发言人：</label>
                        <div class="col-md-9 col-lg-9">
                            <select class="new_msg_speaker form-control" name="new_msg_speaker">
                                <option value="李老师">李老师</option>
                                <option value="曦老师">曦老师</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 col-md-3 control-label">类型：</label>
                        <div class="col-md-9 col-lg-9">
                            <input type="radio" name="new_msg_type" class="new_msg_type" value="1"
                                checked />文字&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <input type="radio" name="new_msg_type" class="new_msg_type"
                                value="2" />音频&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <input type="radio" name="new_msg_type" class="new_msg_type" value="3" />图片
                        </div>
                    </div>
                    <div class="form-group new_msg_file_box">
                        <label class="col-sm-3 col-md-3 control-label">文件：</label>
                        <div class="col-md-9 col-lg-9">
                            <button type="button" class="btn btn-theme03 new_msg_file"><i class="icon-cloud-upload"></i>
                                上传文件</button>
                        </div>
                        <div class="hide">

                        </div>
                    </div>
                    <div class="form-group new_msg_file_box">
                        <label class="col-sm-3 col-md-3 control-label">链接：</label>
                        <div class="col-md-9 col-lg-9">
                            <input type="text" class="new_msg_file_url form-control" name="new_msg_file_url">
                        </div>
                    </div>
                    <div class="form-group new_msg_word_box">
                        <label class="col-sm-3 col-md-3 control-label">内容：</label>
                        <div class="col-md-9 col-lg-9">
                            <textarea class="new_msg_word form-control" wrap="hard" name="new_msg_word"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-12 col-lg-12 text-right">
                            <button type="button"
                                class="btn btn-theme03 new_msg_add">添加</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <button type="button" class="btn btn-default new_msg_cancel">取消</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>





        <div class="single_edit">
            <div class="mask"></div>
            <div class="single_edit_content">
                <form id="single_edit_form" enctype="multipart/form-data" data-article-id="1"
                    class="form-horizontal style-form">
                    <div class="form-group new_edit_file_box">
                        <label class="col-sm-3 col-md-3 control-label">文件：</label>
                        <div class="col-md-9 col-lg-9">
                            <button type="button" class="btn btn-theme03 edit_msg_file"><i class="icon-cloud-upload"></i>
                                上传文件</button>
                        </div>
                    </div>
                    <div class="form-group new_edit_file_box">
                        <label class="col-sm-3 col-md-3 control-label">链接：</label>
                        <div class="col-md-9 col-lg-9">
                            <input type="text" class="edit_msg_file_url form-control" name="new_msg_file_url">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-12 col-lg-12 text-right">
                            <button type="button"
                                class="btn btn-theme03 edit_msg_submit">修改</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <button type="button" class="btn btn-default edit_msg_cancel">取消</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <footer class="site-footer">
            <div class="text-center">
                <a href="#" class="go-top">
                    <i class="icon-angle-up"></i>
                </a>
            </div>
        </footer>
    </section>
    <script type="text/javascript" src="assets/js/jquery-ui-1.9.2.custom.min.js"></script>
    <script type="text/javascript" src="assets/js/jquery.ui.touch-punch.min.js"></script>
    <script type="text/javascript" src="assets/js/jquery.dcjqaccordion.2.7.js"></script>
    <script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>
    <script type="text/javascript" src="assets/js/common-scripts.js"></script>
    <script type="text/javascript" src="assets/js/sessionStorage.js"></script>
    <script type="text/javascript" src="assets/js/default.js"></script>
    <script type="text/javascript" src="assets/js/pages/articleHealthAdd.js"></script>
    <script type="text/javascript" src="assets/js/xlsx.core.min.js"></script>
    <script type="text/javascript" src="assets/js/jquery-sortable.js"></script>
    <script type="text/javascript" src="assets/jodit/build/jodit.min.js"></script>


    <script>
        var editor = new Jodit('#editor', {
            textIcons: false,
            iframe: false,
            iframeStyle: '*,.jodit_wysiwyg {color:red;}',
            height: 300,
            defaultMode: Jodit.MODE_WYSIWYG,
            observer: {
                timeout: 100
            },
            uploader: {
                url: 'http://manager.houaihome.com/jodit/uploadImg'
            },
            commandToHotkeys: {
                'openreplacedialog': 'ctrl+p'
            }
        });

        $('#excel-file').change(function (e) {
            var files = e.target.files;
            // var suffix_file = files.substr(files.lastIndexOf("."));
            // console.log(suffix_file);
            var file_name = $(this).val();
            var suffix_file = file_name.substr(file_name.lastIndexOf("."));
            console.log(suffix_file);
            if (suffix_file !== '.xls' && suffix_file !== '.XLS' && suffix_file !== '.xlsx' && suffix_file !==
                '.XLSX' && suffix_file !== '.et' && suffix_file !== '.ET') {
                alert('请上传正确的EXCEL文件(xls、xlsx、et)!');
                return false;
            }
            var fileReader = new FileReader();
            fileReader.onload = function (ev) {
                try {
                    var data = ev.target.result,
                        workbook = XLSX.read(data, {
                            type: 'binary'
                        }), // 以二进制流方式读取得到整份excel表格对象
                        persons = []; // 存储获取到的数据
                } catch (e) {
                    console.log('文件类型不正确');
                    return;
                }
                var fromTo = '';
                for (var sheet in workbook.Sheets) {
                    if (workbook.Sheets.hasOwnProperty(sheet)) {
                        fromTo = workbook.Sheets[sheet]['!ref'];
                        console.log(fromTo);
                        persons = persons.concat(XLSX.utils.sheet_to_json(workbook.Sheets[sheet]));
                        break;
                    }
                }
                //$(".load_table").html("");
                var li = "";
                for (var j = 0; j < persons.length; j++) {
                    var arr = persons[j];

                    var _tmp = '';
                    var ii = 0;
                    for (var i in arr) {
                        ii++
                        if(ii == 1){
                            _tmp += '<div><input type="hidden" class="courseId" value="" name=""><input type="text" class="speaker form-control" value="'+ arr[i] +'" name="name"></div>';
                        }
                        if(ii == 2){
                            _tmp += '<div>' + arr[i] + '</div>';
                        }
                        if(ii == 3){
                            var this_val = arr[i];
                            var this_type = '1';
                            var point = this_val.lastIndexOf(".");
                            var type = this_val.substr(point);
                            console.log(type);
                            if (type == ".jpg" || type == ".gif" || type == ".JPG" || type == ".GIF" ||
                                type == ".PNG" || type == ".png") {
                                this_val = '<img class="img_in_table" src="' + arr[i] + '" /><a href="javascript:void(0)" class="url_change"><i class="icon-folder-open"></i></a>';
                                this_type = '3';
                            }else if (type == ".mp3" || type == ".MP3" || type == ".wav" || type == ".WAV" ||
                                type == ".WMA" || type == ".wma") {
                                this_val = '<audio src="' + arr[i] +
                                    '" class="audio_36" controls="controls">浏览器不支持audio标签</audio><a href="javascript:void(0)" class="url_change"><i class="icon-folder-open"></i></a>';
                                this_type = '2';
                            }else{
                                this_val = '<p>'+ arr[i] +'</p>';
                            }
                            _tmp += "<div class='l_d' data-type='" + this_type + "'>" + this_val + "<div class='hide'><input class='this_value' type='hidden' value='" + arr[i] +"' name='' /><input class='this_type' type='hidden' value='' name='' /></div></div>";
                        }
                    }
                    li +=
                        "<li data-order='' class='excelcontent'>" +_tmp +"<div><button type='button' class='delete btn btn-primary' href='javascript:void(0);'>删除</button><input class='audio_times' type='hidden' value='0' name='times' /></div></li>";
                }
                $(".load_table").append(li);
            };
            fileReader.readAsBinaryString(files[0]);
        });

        $(function () {
            $("ol.load_table").sortable();
        });
    </script>

</body>

</html>